#!/usr/bin/env sage

from Crypto.Util.number import long_to_bytes

n = 144119247523820514307319742558945817289524321678464785828165262389987364282241677120346992289602773032781170623185859522408681068717004227361637296377314973988883717763449514502353544535632434189976809320943402560377421207936239458384129077990667822889168041784489265932700188699685494064706711885776064499497
a = 83982245487363010227377287615815704138676734572052340268107937333404040064487258387610318909300475704005267406361509228314981566916144028418544919408625857597243933586742790305821574823017061268314657578742703998273111267249007415214833152992932175602495617018238154444547422725699672732735594492967242602718
b = 102854241650706614574910858961148621902783569513613650939938174283440416794379436560775021794677794290971284767314108620894847399989166711219489947662922391647064573171363714323032220660223765035347554282052095512011142748460282601639626032525448005114625186640435086840602281790716023653081557628791656792754
c = [105112301098281496097034027523577403453326764144228787624401074405541577932642530851395484380691290162552636478481380927941044566041120344238783491322553291628678134801814105484196704974017218455216419335693731277825573231392222665423245586612395848380318111988284920983149197374154699808776545479724047776709, 119931822446994265076022490333904239240145849067899601686086810952135061724293475540637951596476598377673280140779509869539582077226280886787012312965074972316057414014195571814522208145587153069696640304889800585974357119323578638404957302760851214606619517664508954712497284900223656294050022339709410514520, 77449803463514047535477961978015960018035778347793833401263588747978475501148536780819549296447786417024775899457091074251167349568353877838782428368954481576827862607179873977973077737374411980559467128298050283927229354740670622117284854556777626729609958202274963553796799701913426256413699327094959918436, 19881898638980767541769585302774976337079209934548061143259050559139791898245439933411471322660256972236103364955342341822881304403603105610433373205174678091884754857958259183427619764249723943787639988589593508171175819610469625589807019978156747244656206732357606116993349990555417285468500357366492529137]

def decrypt(c, G):
    m = b''
    for i in range(len(c) // 2):
        m += long_to_bytes(Integer(G[0]) ^^ c[2*i])
        m += long_to_bytes(Integer(G[1]) ^^ c[2*i+1])
        G = G + G
    return m

P.<x_lower, y_lower> = PolynomialRing(Zmod(n))

x_upper = (c[0] >> 128) << 128
y_upper = (c[1] >> 128) << 128

x = (x_upper + x_lower)
y = (y_upper + y_lower)

f = y^2 - (x^3 + a * x + b)

# https://raw.githubusercontent.com/defund/coppersmith/master/coppersmith.sage
load("coppersmith.sage")

res = small_roots(f, [2^128, 2^128])[0]

E = EllipticCurve(Zmod(n), [a, b])
G = E(x_upper + res[0], y_upper + res[1])

FLAG = decrypt(c, G)
print(FLAG)

# zer0pts{th3_g00d_3ncrypti0n_c0m3s_fr0m_th3_g00d_curv3}
