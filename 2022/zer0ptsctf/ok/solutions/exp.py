#!/usr/bin/env python3

from pwn import *
from Crypto.Util.number import inverse, isPrime, long_to_bytes

P = 2 ** 1000 - 1
while not isPrime(P): P -= 2

IP = b"crypto.ctf.zer0pts.com"
PORT = 10333

'''
num = 16

def get_sample(io):
    _, n, _, x1, x2 = [int(io.recvline().strip().split(b' = ')[1]) for _ in range(5)]
    v = ((x1 + x2) * inverse(2, n)) % n
    io.sendlineafter(b"v:", str(v).encode())
    c1, c2 = [int(io.recvline().strip().split(b' = ')[1]) for _ in range(2)]
    return ((c1 + c2) % n, n)

def collect_samples(num):
    samples = []
    for _ in range(num):
        io = remote(IP, PORT)
        samples.append(get_sample(io))
        io.close()
    return samples

samples = collect_samples(num)
print(samples)

[(53536597532072001987953947618348278754627989400141287390121235069154684901151037785859748979184936316373631831902809146296283677943962597534604255525506249461823500337285379914808964474967526592872056505342589956015812932016802878587968868709680902283391534727308782525444356458981946446499414654860284614520, 81532346990774035744149246687093739233563562488458025862353616811236592929927520013119734668192646961533496238336005840784718084030439712537516379227930454525398092222002748924190455613561037274262352611931228672169210405437515592633513976475385326451752928613223415909527061004459451687447536250438229313069), (66386312979313505149678133618856326319144553867702702385459153922747133031832397726785477639639118882220170181625651486209470420966794432855675760314140012404627473371964709165160895356332613716904862259760517220361299732389620364471023261156059281453710486335747739945414679129863018461429414603001697857446, 85261174871158793253251170096511329507950686012074175900297285932651459506466746833163233092110500260549112493891581801968326642820433154669204159233728445782735602091499081907681369237358292009672666790493125251265942836555505937199247016288696624486907900686233350997519714072921767900692658314341012697759), (82855910653571630421199586924290064641069898105009142491744415247047599925885867039675967433720877808837246893311086073625722335037176224944857408250783926787144552596936522944040355322283616854035345559542320221492782450762163375201132232198068564031292204827087344481753790175496844488214113399995621073845, 175296969798299274968012557170786092368204173509397227075563908445145281198388897932364983269564267700333186289328071508577281037265568594514552605443434849991432746122699895626574443768655211328254129356662362506444040888980557759944656814565739883517030509048164654789764265904377468502220390524717144235377), (67917841804732892981689897447067140250243688025894008707908785067903516730398892671208420467083015889709569161380034225841358061202903976101599885558281852732919925626113564403638386068192561694670751983174125962185889319180209997089150558713993053147437431514377524625946266322586240693521822157166913253252, 88945357251734933212352813578204370187949945474353763777144766387399403591004152716280959974027281030278966278660429855453466282481306531535008696456716849750359105560256589689405438426151043540639002283687324388798663877159884907300822253960925023688296255695337838887696136134077868905004005388733761580373), (9918102878229228388874703456709588349378129769200711367564918198958852463645060076822096286250103595406606762580385796743618856746481962289054262516759351728219898056054817253724902960895874747322046895326594875565470960140720807985078294650630937681577127061805103991591163481821481426681271204599230185380, 82826113536597745438466005687363774762514680698836237724434795687170677475999743373776958888324279961192900092635793403736543957087705717570584175426488425111499259180875471482211050794545424119388095632420668163381967137097789818040239897003474370113845568028535258944393437759425034717567600281696518871953), (38647603252527852986056757841524867125798897767982344531034814112894042422125890184740916374018986718308171159051726360766848509497563357986388009443288662663268816790699597542637089823398187381224886625292002476565982624482518341777098829293273611491271659781482529095516878330486493753850170264157589438416, 138476228446422586892776260074260849572691619458178888868254473908612520961319842298125975058855978296637345917187724904228605323458967308867483788442088221235878971910361103233086723179579222334058587679030246864138858393651841053946357488958447272497502288654198747265098818037897999131898889586542009950937), (12922793948371249596333839961495120188622006030071522465751878338793053410381612720446171918966667244493291904157802808744874379813003419660789753533345449527388070542963892747439687198664780515313515490945084035984866758354437223206582784772935582049082136715363859748337920403307640846903361021833332273246, 85070989668988318423769076350243749988573922135666558027845497016513511561825772224196335654464772069139283864144466116283948223181426411410690126065180704586874374578437305232415505990631813624180673373180769230119586952253097647501637943006674898068390698652697457330445914017080754067381195969202597654983), (51701453524123685823853237186189368497038297467549719028646687238972549222635628300375346182909664168258392686785026606591555924060936676672346368867560301435038900425899745463394600756485508100552827527922944186849834413179778459676140968494956421892026812687339321993763142060591336096874050090911999068980, 97499580437621235504955638537998177847885171111473693129301729724019726521644187005991238134209149047737502657226546329139736509043052126109113900842163120009252934655129552383127561287458225200533709765229189716376647572182692671878024320843749631341196992905049046275148981868487961104620760469703638931489), (63606056396031463747097593535358131813024723886573785223005230849871488541276385046641768753948733395454300850482855956945502304269996451557538283723998735144021373054820713745434677676831159882841293589885728873727593790166950687563427703302352421956683736286610883874569904871870018352042627786917388299036, 108338653083931371897153187094147035434160799810403104262313137502934110697881106000854750513971052821128355676671449777371457425855343449915488021688758234224358850561938249501868133216361775461258227925887527432901207288890232471732957188104262220713360962297927064953781035643825292899945120843589631670301), (61882351593000421073469028566205790661324055525768790116189817078842441754516769353741833078931220847679953006428418186322789756287281510624875607231660308780385681740327424534040370249270052649400732163625677325049975010796407196280403531462149224024265856670664923794235397963894480618288468315379715003470, 157173285756570107035567394879810114583855676263259883686462144635173379207504457425375137887660165209809094378196183223607716498100505448415719652503280182500288623917412333422439070924223028206016178538058867209887547287223819355822568724894475264193868180911244589267762917665209170118610047883715809265243), (18104666867760850446309860325586065982793938536636445550682886250279280490370489197473982640922834049465916688344408877409039725813152420731350562922947830970511215888675435524487080966121102426974997257627731487442056273967049258672906784950284574417578718984715097114739309173203179505890098315062855981657, 72560161702945573305264278661605157695604768546718301219730355394601875967172019497529510492875524283116947485319724522818156001311755873210626008662510363339536254059189610235032697014226792775159218385534173187842551461291551313912334924879273962435090667312489814378126284305604886992451007885865591780893), (53357724543145768207676668187683058033403406759871687094086725379179160441518786386196523812535796962665272643877829554631905985202478863136292737945895675365558138784310577831880661842974697744594435125909840765288412146607409352428426678455043366326279655738194079965352177411281261596026566035674725735721, 59893212362815907532405947087025784708085266116769057039898147354412925044090153220989042284103404325854687552680012599928332894513456335262880534826337590163838342930824227485064719377091898309302249571067022332968710892445831379772706779065168876516673217263162588898769219718041828688140363769348530713353), (79929903390821367692644953497965456334197200271514348086515671944822306923569389587479278056502064631912551436400038874796089912525859807306028845613675345738316809974393210161335214317317282547424054232420491101188156464876387880719760762503395188783671020161716719019778279586253762103638437939434249381790, 89857961139816757150008815703465681491823059483772115999436833507289874036892061810214015243642525942721901926860851073361846506782557434229802427653862140158941076502840928350267010916993713024528623753675318913255586773545044379200763238273413176817483189541866246342916249955844389812223944865886002984471), (21505582821466200004550013870876525104143447421072525389743751465049894741375581789195097314490198664535226894031552067088637007426445474357150470112902853872292536744022315506584191004779933645154467378082672903973853201180861916991685506552696921837519444835296679259733857836846281378905045037595828160550, 150737832454836838500326536775308771471444851443044830208569933261898479542661796708651643441499189533372883845870769555298280270795638583554823227035816127645191805608376457068032602851025568793255778257480661288339657259055699804926183278881555271631550739092203684549531599188818907975580545140214797851939), (82409356647183954748198683422184212128218785230389996632722757273347685223296458202528209288822751955981501597443917159414291964759153758751018882035410611836724686857260327871148605267702566763085184299583681042659579950374534641518425863933157292273784045394943637325363728879884192410558789629753515057646, 127452726297140854633943977344185341055295879471863825553572497969118138186094336216463269088294103850407124046787775840324828149999596812286314423700116140000190120997333240581934255678045423527231409988904383911997279280530072699607175128832740184027373226582984315594618448896686759831224822467316794933847), (59611233493767294865241875523285018578076701474875291037731706834102783130367497366904089991011083387887515492253390323775891288461165880963194969438113604899223949737153494350454308064086321567650145539417270826198663132565208510441331902138281570878400072595731357019885600647732321926738273947562608157644, 70157241726529440645397841489302449402881034601267355956945050347542155838719997034454810241751931940985895991769931004432951109310307279734526471568638191966641028466576604323633293557960065610319052552109360186309611648176130095280945168688693570186168845032956654655301306568531047995477329233731229956329)]
'''

samples = [(53536597532072001987953947618348278754627989400141287390121235069154684901151037785859748979184936316373631831902809146296283677943962597534604255525506249461823500337285379914808964474967526592872056505342589956015812932016802878587968868709680902283391534727308782525444356458981946446499414654860284614520, 81532346990774035744149246687093739233563562488458025862353616811236592929927520013119734668192646961533496238336005840784718084030439712537516379227930454525398092222002748924190455613561037274262352611931228672169210405437515592633513976475385326451752928613223415909527061004459451687447536250438229313069), (66386312979313505149678133618856326319144553867702702385459153922747133031832397726785477639639118882220170181625651486209470420966794432855675760314140012404627473371964709165160895356332613716904862259760517220361299732389620364471023261156059281453710486335747739945414679129863018461429414603001697857446, 85261174871158793253251170096511329507950686012074175900297285932651459506466746833163233092110500260549112493891581801968326642820433154669204159233728445782735602091499081907681369237358292009672666790493125251265942836555505937199247016288696624486907900686233350997519714072921767900692658314341012697759), (82855910653571630421199586924290064641069898105009142491744415247047599925885867039675967433720877808837246893311086073625722335037176224944857408250783926787144552596936522944040355322283616854035345559542320221492782450762163375201132232198068564031292204827087344481753790175496844488214113399995621073845, 175296969798299274968012557170786092368204173509397227075563908445145281198388897932364983269564267700333186289328071508577281037265568594514552605443434849991432746122699895626574443768655211328254129356662362506444040888980557759944656814565739883517030509048164654789764265904377468502220390524717144235377), (67917841804732892981689897447067140250243688025894008707908785067903516730398892671208420467083015889709569161380034225841358061202903976101599885558281852732919925626113564403638386068192561694670751983174125962185889319180209997089150558713993053147437431514377524625946266322586240693521822157166913253252, 88945357251734933212352813578204370187949945474353763777144766387399403591004152716280959974027281030278966278660429855453466282481306531535008696456716849750359105560256589689405438426151043540639002283687324388798663877159884907300822253960925023688296255695337838887696136134077868905004005388733761580373), (9918102878229228388874703456709588349378129769200711367564918198958852463645060076822096286250103595406606762580385796743618856746481962289054262516759351728219898056054817253724902960895874747322046895326594875565470960140720807985078294650630937681577127061805103991591163481821481426681271204599230185380, 82826113536597745438466005687363774762514680698836237724434795687170677475999743373776958888324279961192900092635793403736543957087705717570584175426488425111499259180875471482211050794545424119388095632420668163381967137097789818040239897003474370113845568028535258944393437759425034717567600281696518871953), (38647603252527852986056757841524867125798897767982344531034814112894042422125890184740916374018986718308171159051726360766848509497563357986388009443288662663268816790699597542637089823398187381224886625292002476565982624482518341777098829293273611491271659781482529095516878330486493753850170264157589438416, 138476228446422586892776260074260849572691619458178888868254473908612520961319842298125975058855978296637345917187724904228605323458967308867483788442088221235878971910361103233086723179579222334058587679030246864138858393651841053946357488958447272497502288654198747265098818037897999131898889586542009950937), (12922793948371249596333839961495120188622006030071522465751878338793053410381612720446171918966667244493291904157802808744874379813003419660789753533345449527388070542963892747439687198664780515313515490945084035984866758354437223206582784772935582049082136715363859748337920403307640846903361021833332273246, 85070989668988318423769076350243749988573922135666558027845497016513511561825772224196335654464772069139283864144466116283948223181426411410690126065180704586874374578437305232415505990631813624180673373180769230119586952253097647501637943006674898068390698652697457330445914017080754067381195969202597654983), (51701453524123685823853237186189368497038297467549719028646687238972549222635628300375346182909664168258392686785026606591555924060936676672346368867560301435038900425899745463394600756485508100552827527922944186849834413179778459676140968494956421892026812687339321993763142060591336096874050090911999068980, 97499580437621235504955638537998177847885171111473693129301729724019726521644187005991238134209149047737502657226546329139736509043052126109113900842163120009252934655129552383127561287458225200533709765229189716376647572182692671878024320843749631341196992905049046275148981868487961104620760469703638931489), (63606056396031463747097593535358131813024723886573785223005230849871488541276385046641768753948733395454300850482855956945502304269996451557538283723998735144021373054820713745434677676831159882841293589885728873727593790166950687563427703302352421956683736286610883874569904871870018352042627786917388299036, 108338653083931371897153187094147035434160799810403104262313137502934110697881106000854750513971052821128355676671449777371457425855343449915488021688758234224358850561938249501868133216361775461258227925887527432901207288890232471732957188104262220713360962297927064953781035643825292899945120843589631670301), (61882351593000421073469028566205790661324055525768790116189817078842441754516769353741833078931220847679953006428418186322789756287281510624875607231660308780385681740327424534040370249270052649400732163625677325049975010796407196280403531462149224024265856670664923794235397963894480618288468315379715003470, 157173285756570107035567394879810114583855676263259883686462144635173379207504457425375137887660165209809094378196183223607716498100505448415719652503280182500288623917412333422439070924223028206016178538058867209887547287223819355822568724894475264193868180911244589267762917665209170118610047883715809265243), (18104666867760850446309860325586065982793938536636445550682886250279280490370489197473982640922834049465916688344408877409039725813152420731350562922947830970511215888675435524487080966121102426974997257627731487442056273967049258672906784950284574417578718984715097114739309173203179505890098315062855981657, 72560161702945573305264278661605157695604768546718301219730355394601875967172019497529510492875524283116947485319724522818156001311755873210626008662510363339536254059189610235032697014226792775159218385534173187842551461291551313912334924879273962435090667312489814378126284305604886992451007885865591780893), (53357724543145768207676668187683058033403406759871687094086725379179160441518786386196523812535796962665272643877829554631905985202478863136292737945895675365558138784310577831880661842974697744594435125909840765288412146607409352428426678455043366326279655738194079965352177411281261596026566035674725735721, 59893212362815907532405947087025784708085266116769057039898147354412925044090153220989042284103404325854687552680012599928332894513456335262880534826337590163838342930824227485064719377091898309302249571067022332968710892445831379772706779065168876516673217263162588898769219718041828688140363769348530713353), (79929903390821367692644953497965456334197200271514348086515671944822306923569389587479278056502064631912551436400038874796089912525859807306028845613675345738316809974393210161335214317317282547424054232420491101188156464876387880719760762503395188783671020161716719019778279586253762103638437939434249381790, 89857961139816757150008815703465681491823059483772115999436833507289874036892061810214015243642525942721901926860851073361846506782557434229802427653862140158941076502840928350267010916993713024528623753675318913255586773545044379200763238273413176817483189541866246342916249955844389812223944865886002984471), (21505582821466200004550013870876525104143447421072525389743751465049894741375581789195097314490198664535226894031552067088637007426445474357150470112902853872292536744022315506584191004779933645154467378082672903973853201180861916991685506552696921837519444835296679259733857836846281378905045037595828160550, 150737832454836838500326536775308771471444851443044830208569933261898479542661796708651643441499189533372883845870769555298280270795638583554823227035816127645191805608376457068032602851025568793255778257480661288339657259055699804926183278881555271631550739092203684549531599188818907975580545140214797851939), (82409356647183954748198683422184212128218785230389996632722757273347685223296458202528209288822751955981501597443917159414291964759153758751018882035410611836724686857260327871148605267702566763085184299583681042659579950374534641518425863933157292273784045394943637325363728879884192410558789629753515057646, 127452726297140854633943977344185341055295879471863825553572497969118138186094336216463269088294103850407124046787775840324828149999596812286314423700116140000190120997333240581934255678045423527231409988904383911997279280530072699607175128832740184027373226582984315594618448896686759831224822467316794933847), (59611233493767294865241875523285018578076701474875291037731706834102783130367497366904089991011083387887515492253390323775891288461165880963194969438113604899223949737153494350454308064086321567650145539417270826198663132565208510441331902138281570878400072595731357019885600647732321926738273947562608157644, 70157241726529440645397841489302449402881034601267355956945050347542155838719997034454810241751931940985895991769931004432951109310307279734526471568638191966641028466576604323633293557960065610319052552109360186309611648176130095280945168688693570186168845032956654655301306568531047995477329233731229956329)]

def calc_distribution(k):
    dist = [set() for i in range(1 << k)]
    for a in range(1 << k):
        for x in range(1 << k):
            for c in range(2):
                b = (x + (x ^ a) + c) & ((1 << k) - 1)
                dist[a].add(b)
    return dist

def slide_window(samples, pos, width):
    return set([(i >> pos) & ((1 << width) - 1) for i in samples])

def solve(samples, k):
    guess = 0
    step = 1
    for i in range(1000 // step):
        window = slide_window(samples, i * step, k)
        x = max([i for i in range(len(dist)) if all(j in dist[i] for j in window)])
        guess |= (x & ((1 << step) - 1)) << (i * step)
    return guess

def handle_samples(samples):
    s0 = [i if not i & 1 else i + N for i, N in samples]
    s1 = [i if i & 1 else i + N for i, N in samples]
    return (s0, s1)

K = 12
dist = calc_distribution(K)

s = handle_samples(samples)
res = [solve(i, K) for i in s]

for ct in res:
    print(long_to_bytes(pow(ct, inverse(65537, P - 1), P)))

# zer0pts{hav3_y0u_unwittin91y_acquir3d_th3_k3y_t0_th3_d00r_t0_th3_N3w_W0r1d?}
